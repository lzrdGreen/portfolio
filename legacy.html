<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Legacy Projects</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="icon" type="image/png" href="images/lzrdGreen.jpg">
</head>
<body>
  <header>
    <h1>Oleksandr Parshakov</h1>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="proj.html">Portfolio</a></li>
            <li><a href="legacy.html">Legacy Projects</a></li>
            <li><a href="cloud.html">My Cloud Journey</a></li>
            <li><a href="about.html">About Me</a></li>               
        </ul>
    </nav>
  </header>

  <main>
    <h1 id="top">Legacy Projects</h1>

    <h3>CIFAR-10 Image Classification with Deep Learning</h3>
    <h4>(2021)</h4>
    <p><strong>Summary: </strong>This project explores deep learning for a computer vision task on the CIFAR-10 dataset, a standard benchmark for 10-class image classification. The project proceeds in two phases. The initial phase involves experimenting with a basic Convolutional Neural Network (CNN) containing just two convolutional layers using ReLU and Sigmoid activations, followed by experiments with Multi-Layer Perceptrons (MLPs), to demonstrate the importance of convolutional layers for image data and the relative performance of different activation functions. This initial CNN achieved only 63% accuracy. The second phase focuses on developing a more complex CNN architecture, drawing inspiration from VGG-style networks in terms of depth and filter sizes, with the goal of exceeding 80% accuracy on a personal computer equipped with a single GPU. By incorporating techniques like batch normalisation and multi-scale convolutional filters, the final model achieved 88% accuracy on the CIFAR-10 test set, surpassing the initial goal and demonstrating the effectiveness of the chosen approach within the given resource constraints.</p>
    <ul>
      <li><p><strong>Problem: </strong>This project aimed to develop an effective deep learning model for the CIFAR-10 dataset within the constraints of a personal computer equipped with a single GTX 1070 GPU. The key challenges included:</p>
      <ol type="i">
        <li><p><strong>Demonstrating the Importance of Convolutional Layers: </strong>Initial experiments with a basic two-layer CNN achieved only 63% accuracy. Subsequent trials with Multi-Layer Perceptrons (MLPs) performed even worse, clearly demonstrating the necessity of convolutional layers for effectively extracting features from image data. This comparison motivated the focus on a more advanced approach.</p></li>
        <li><p><strong>Achieving High Accuracy with Limited Resources: </strong>While established architectures like VGG-16/19 can achieve 90–93% accuracy on CIFAR-10 (and even higher with data augmentation), training such computationally intensive models from scratch was impractical on the available hardware. The challenge was to design a model that approached this level of performance while remaining feasible to train with limited resources.</p></li>
        <li><p><strong>Optimising Training Strategies: </strong>To maximise performance within the resource constraints, the project employed techniques like batch normalisation and multi-scale convolutional filters to improve accuracy and training stability. The target was to achieve an accuracy exceeding 80% without relying on extensive and complex training pipelines.</p></li>
      </ol>
      </li>
      <li><p><strong>Solution: </strong></p>
        <p>To address the challenges outlined in the previous section, the project implemented the following solution:</p>
  <ol type="i">
    <li>
      <p><strong>Custom CNN Architecture:</strong> A custom CNN architecture was developed, drawing inspiration from Inception model in its use of multiple convolutional layers with varying filter sizes (3x3, 5x5, 7x7, and 9x9). This multi-scale approach aimed to capture features at different levels of detail. The architecture incorporated:</p>
      <ul>
        <li><p>The convolutional section comprised an initial multi-scale feature extraction stage (four parallel convolutions with 3x3 to 9x9 kernels), three subsequent convolutional blocks with varying combinations of operations (convolutions, concatenations, batch normalization, and activations), and a final feature concatenation stage (two parallel convolutions).</p></li>
        <li><p>Leaky ReLU activation functions (negative slope = 0.1) after the first set of concatenated convolutional layers (<code>act</code>) for improved gradient flow.</p></li>
        <li><p>Batch normalisation layers (<code>bn1</code> and <code>bn2</code>) strategically placed after the concatenation and activation operations to stabilize training and act as regularisation.</li>
        <li><p>Max pooling layers (<code>maxpool1</code> and <code>maxpool2</code>) to reduce spatial dimensions and introduce translation invariance.</p></li>
        <li><p>A series of fully connected layers (<code>fc1</code> to <code>fc5</code>) with ReLU activations, culminating in a final output layer with 10 neurons for the 10 CIFAR-10 classes.</p></li>
      </ul>
    </li>
    <li>
      <p><strong>Training Optimisation:</strong> The model was trained for 40 epochs using the following setup:</p>
      <ul>
        <li><p>Batch size of 16 to manage memory usage on the GTX 1070 GPU.</p></li>
        <li><p>Cross-entropy loss function, suitable for multi-class classification.</p></li>
        <li><p>Stochastic Gradient Descent (SGD) optimiser with momentum (0.9).</p></li>
        <li><p>A dynamic learning rate schedule to fine-tune the model during training. The learning rate was initially set to 0.001 for the first 20 epochs. After observing that the validation loss plateaued, the learning rate was reduced to 3e-4 for the next 10 epochs (epochs 21-30). Finally, for the last 10 epochs (epochs 31-40), the learning rate was further reduced to 1e-4 to facilitate finer adjustments and potentially escape local minima.</p></li>
      </ul>
    </li>
  </ol>
        <p>This strategy allowed the model to achieve 88% accuracy on the CIFAR-10 test set, surpassing the initial target of 80% and demonstrating the effectiveness of the chosen architecture and training regimen within the given resource constraints. The use of batch normalisation proved sufficient for regularisation, eliminating the need for dropout.</p>
  </li>
      <li><p><strong>Impact: </strong>This project provided valuable practical experience in designing and training deep learning models within resource constraints. It solidified my understanding of convolutional layers and their crucial role in image data processing, along with the performance benefits of architectural innovations like multi-scale feature extraction. I also gained proficiency in optimization techniques, including dynamic learning rate schedules and batch normalisation, for stabilizing training and maximizing accuracy. Successfully building and fine-tuning a custom CNN architecture to achieve 88% accuracy on CIFAR-10 with limited resources showcased my ability to balance computational efficiency with performance—a critical skill for deep learning research and real-world applications.</p></li>      
    </ul>  

    <p>GitHub repo: <a href="https://github.com/lzrdGreen/Models-for-CIFAR-10">github.com/lzrdGreen/Models-for-CIFAR-10</a></p>
    <p><strong>Relevant skills: </strong>Python, PyTorch, Scikit-Learn, matplotlib, numpy, pandas</p>

    <figure>
      <img src="images/loss.png" alt="Loss for training and validaion sets">
      <p>Loss for training and validaion sets.</p>
    </figure>
    <p><a href="#top">Jump to the Top</a></p>


    <h2 id="bert">Application of BERT, a Transformer-based language model, to check the correctness of a sentence in English</h2>
    <h3>(September 2021)</h3>
    <p><strong>Summary: </strong>This project tackled the challenge of grammatical error detection in English using Natural Language Processing (NLP) by fine-tuning a pre-trained BERT model with the CoLA dataset. The implementation was completed on a personal computer with a single GTX 1070 GPU, demonstrating the accessibility of advanced NLP techniques without requiring high-performance computing clusters. By validating the model's performance on real-world examples, the project showcased BERT's potential for nuanced linguistic tasks, contributing to understanding fine-tuning techniques and paving the way for practical applications like grammar checkers and language learning tools.</p>
    <ul>
      <li><p><strong>Problem: </strong>The core problem addressed by this project is the difficulty of accurately and efficiently detecting grammatical errors in English sentences. While humans can generally identify many grammatical mistakes, the process is time-consuming and prone to inconsistencies. At the time of this project (September 2021), Natural Language Processing (NLP) was advancing rapidly, with large language models (LLMs) like BERT demonstrating promising capabilities in various language-based tasks. However, many introductory NLP applications focus on simpler classification tasks like sentiment analysis, which, thanks to readily available pre-trained models, have become remarkably streamlined. For instance, models like <code>cardiffnlp/twitter-roberta-base-sentiment-latest</code> (fine-tuned on a large dataset of tweets labeled with sentiment) from the Hugging Face Model Hub can be directly employed for accurate sentiment classification using only a simple downstream classifier like logistic regression, without requiring further training. Grammatical error detection, a more nuanced challenge, presents an opportunity to explore the potential of LLMs more deeply. Inspired by Chris McCormick's work utilising the Corpus of Linguistic Acceptability (CoLA) dataset and his provided Jupyter Notebook demonstrating fine-tuning a standard pre-trained 12-layer uncased BERT model (released in 2018), this project aimed to replicate and evaluate this fine-tuning process on a personal computing setup (single GTX 1070 GPU). This addressed the need for more sophisticated NLP tasks beyond basic sentiment analysis and explored the practical application of cutting-edge LLMs on readily available hardware.</p></li>

      <li><p><strong>Solution: </strong>This project implemented a solution based on fine-tuning a pre-trained BERT model for binary classification of grammatical acceptability using the CoLA dataset. The key steps involved:</p>
        <ol type="i">
          <li><p><strong>Data Preprocessing: </strong>The CoLA dataset, containing sentences labeled as grammatically acceptable or unacceptable, was loaded into a pandas DataFrame and tokenised using <code>BertTokenizer</code>. This crucial step mapped sentences to numerical representations, a sequence of tokens, that the BERT model could understand.</p></li>
          <li><p><strong>Fine-tuning BERT: </strong>A pre-trained BERT model was fine-tuned specifically for this task. A <code>BertForSequenceClassification</code> transformer model, with a single linear layer on top of the BERT output, was used for binary classification (grammatically correct or incorrect). This process adapted the pre-trained model's knowledge to the specific task of grammatical error detection.</p></li>
          <li><p><strong>Training: </strong>The model was trained using the AdamW optimiser, a common choice for fine-tuning transformer models. This leveraged the pre-trained weights of BERT while optimising the model's parameters on the CoLA data.</p></li>
          <li><p><strong>Evaluation: </strong>The model's performance was primarily evaluated using real-world examples from a reputable source: Michael Swan's "Practical English Usage," an Oxford University Press publication. This approach was chosen due to the difficulty in interpreting metrics like MCC or F1 in isolation. Two pairs of sentences (one grammatically correct and one incorrect in each pair) were used to validate the model's generalization ability beyond the CoLA training data. The model successfully identified the grammatical correctness in all pairs, providing qualitative evidence of its effectiveness and practical applicability.</p></li>
        </ol></li>

      <li><p><strong>Impact: </strong>This project demonstrated the feasibility of using powerful LLMs like BERT for complex NLP tasks like grammatical error detection, even with limited computational resources. The impact extends beyond a simple demonstration of technology, contributing to the understanding and application of fine-tuning techniques, validating the real-world applicability of BERT for grammatical error detection, and opening avenues for future research and development in language technology. Specifically, the project:</p>
        <ol type="i">
          <li><p><strong>Proof of Concept: </strong>While BERT is widely used for various NLP tasks, this project specifically showcased its effectiveness in the less common domain of grammatical correctness classification. This contributes to a broader understanding of BERT's versatility and its potential for addressing nuanced linguistic challenges.</p></li>
          <li><p><strong>Practical Validation: </strong>By moving beyond standard dataset evaluation and testing the model on real-world examples from a reputable grammar resource (Michael Swan's "Practical English Usage"), the project validated the model's ability to generalise to unseen data and address real-world linguistic challenges. This highlights the practical utility of fine-tuned language models in improving writing quality and language learning. This practical validation is a key contribution of the project.</p></li>
          <li><p><strong>Advanced understanding of fine-tuning: </strong>The project deepened the author's understanding of the intricacies of fine-tuning pre-trained models, including data preprocessing, model selection, training procedures, and evaluation strategies. This contributes to a growing body of knowledge on effective fine-tuning practices and provides a valuable learning experience.</p></li>          
          <li><p><strong>Potential for real-world applications: </strong>While this project was a proof-of-concept, it demonstrates the potential for developing practical applications such as advanced grammar checkers, language learning tools that provide detailed feedback on grammatical errors, and improved machine translation systems that produce more grammatically sound output.</p></li>
          <li><p><strong>Accessibility: </strong>By successfully implementing the fine-tuning on a personal computer with a single GTX 1070 GPU, the project made this advanced NLP technique more accessible to a wider audience, demonstrating that high-performance computing clusters are not always necessary.</p></li>
          <li><p><strong>Reproducibility: </strong>By replicating existing work (while adapting the evaluation method), the project contributed to the reproducibility of NLP research and provided a valuable learning resource for others interested in exploring LLMs.</p></li>
        </ol>        
      </li>
    </ul>

    
    <p>GitHub repo: <a href="https://github.com/lzrdGreen/English-Grammar-Tester">English Grammar Tester</a></p>

    <p><strong>Relevant skills: </strong>Python, PyTorch, Scikit-Learn, matplotlib, numpy, pandas</p>
    
    <p><a href="#top">Jump to the Top</a></p>

    <h2 id="fine-tuning">Fine Tuning of Qwen2.5-0.5B-Instruct Model</h2>
    <h3>(2025)</h3>
    
    <p>My 2021 project, <a href="#bert">"Application of BERT to check the correctness of a sentence,"</a> has found an unexpected continuation. While BERT—a masked language model specialised in question answering and sentence classification—represented one approach, generative LLMs now offer an alternative path.</p>
    <p>I'm exploring these models through hands-on training on my personal laptop, which limits me to small-scale/compact LLMs. Qwen2.5-0.5B-Instruct is one of them, a tiny LLM with half a billion parameters.</p>

    <p>I assessed various fine-tuning techniques (Table 1 below), using perplexity (PPL) as the evaluation metric—this quantifies how well the model predicts the next token, with lower scores indicating better performance. Each model version was evaluated using diverse prompts, compared against the baseline Qwen2.5-0.5B-Instruct model without fine-tuning.</p>

    <p>I first investigated two approaches: <a href="https://lzrdgreen.github.io/LLMs/SFT.html">Supervised Fine-Tuning (SFT)</a> on conversational <code>HuggingFaceH4/ultrachat_200k</code> dataset, and <a href="https://lzrdgreen.github.io/LLMs/dpo9.html">Direct Preference Optimisation (DPO)</a> on <code>argilla/distilabel-intel-orca-dpo-pairs</code> dataset of accepted/rejected response pairs. Contrary to common belief that human expertise benefits LLM performance, DPO showed virtually no improvement over baseline and proved challenging for my RTX 4080 GPU—the session with the best <code>evaluation_loss</code> ended in a runtime error near completion. More stable settings yielded slightly worse <code>evaluation_loss</code> results. In contrast, <a href="https://lzrdgreen.github.io/LLMs/SFT.html">Supervised Fine-Tuning (SFT)</a> demonstrated significant improvements, producing the best models according to PPL metrics. The same Jupyter notebook contains evaluation runs for both the baseline model and the pure DPO model loaded from its best checkpoint.</p>

    <p>Given DPO's discouraging results, I tested applying DPO after initial SFT (see <a href="https://lzrdgreen.github.io/LLMs/DPOafterSFT.html">DPOafterSFT notebook</a>). This approach deteriorated PPL, but less severely than pure DPO.  I then applied a second round of SFT to create an <a href="https://lzrdgreen.github.io/LLMs/SFTDPOSFT.html">SFT-DPO-SFT</a> sequence, which yielded significant improvements nearly matching pure SFT. However, determining which metrics best reflect human preferences remains challenging.</p>
    <p>Notably, all models performed strongest on creative writing tasks (e.g., "Write a scene from a play..."). Interestingly, while most factual prompts received good PPL scores, the specific prompt "Give me three facts about London" proved challenging for all models—possibly because the abundance of potential facts makes selection difficult.</p>
    <h3>Table 1.</h3> 
    <h3>Perplexity for Fine-Tuned Qwen2.5-0.5B-Instruct Model Using Various Techniques</h3>
    <div style="overflow-x:auto;">
      <table>
        <tr>
          <th>Prompt</th>
          <th>Supervised Fine Tuning</th>
          <th>Direct Preference Optimisation</th>
          <th>DPOafterSFT</th>
          <th>SFT-DPO-SFT</th>
          <th>Baseline</th>
        </tr>
        <tr>
          <th>What is AI?</th>
          <th>88.66</th>
          <th>178.1</th>
          <th>104.6</th>
          <th>93.62</th>
          <th>179.5</th>
        </tr>
        <tr>
          <th>Tell me something interesting about Albert Einstein.</th>
          <th>60.97</th>
          <th>124.8</th>
          <th>74.59</th>
          <th>61.76</th>
          <th>118.6</th>
        </tr>
        <tr>
          <th>Tell me something about Large Language Models.</th>
          <th>86.54</th>
          <th>120.5</th>
          <th>94.39</th>
          <th>87.35</th>
          <th>119.8</th>
        </tr>
        <tr>
          <th>What is geometry? Explain it step by step.</th>
          <th>50.75</th>
          <th>80.79</th>
          <th>60.04</th>
          <th>54.14</th>
          <th>80.46</th>
        </tr>
        <tr>
          <th>Explain the concept of entropy in simple terms.</th>
          <th>42.76</th>
          <th>60.68</th>
          <th>44.75</th>
          <th>42.43</th>
          <th>60.53</th>
        </tr>
        <tr>
          <th>Tell me something about Jean Baudrillard.</th>
          <th>50.86</th>
          <th>82.91</th>
          <th>55.48</th>
          <th>51.20</th>
          <th>81.40</th>
        </tr>
        <tr>
          <th>Who was David Hilbert?</th>
          <th>91.98</th>
          <th>179.7</th>
          <th>131.0</th>
          <th>99.74</th>
          <th>176.0</th>
        </tr>
        <tr>
          <th>Give me three facts about London.</th>
          <th>108.7</th>
          <th>204.4</th>
          <th>120.2</th>
          <th>109.3</th>
          <th>200.9</th>
        </tr>
        <tr>
          <th>Tell a short story about enemies who eventually became friends, why did it happen?</th>
          <th>86.02</th>
          <th>117.0</th>
          <th>97.68</th>
          <th>86.90</th>
          <th>114.8</th>
        </tr>
        <tr>
          <th>Write a scene from a play where two men are having a philosophical debate about the nature of consciousness.</th>
          <th>24.19</th>
          <th>32.03</th>
          <th>25.83</th>
          <th>24.79</th>
          <th>31.64</th>
        </tr>
        <tr>
          <th>Imagine you are a time traveler who has just arrived in the remote future. Describe what you observe that is significantly different from today.</th>
          <th>27.74</th>
          <th>36.18</th>
          <th>30.26</th>
          <th>28.76</th>
          <th>36.16</th>
        </tr>
        <tr>
          <th>Tell me something about love.</th>
          <th>76.32</th>
          <th>138.5</th>
          <th>87.30</th>
          <th>77.46</th>
          <th>136.0</th>
        </tr>
      </table>
    </div>
    <p><a href="#top">Jump to the Top</a></p>
  </main>

  

  <footer>
    <p>&copy; 2025 Oleksandr Parshakov</p>    
    <p><a href="https://www.linkedin.com/in/alexander-parshakov/">LinkedIn</a> | <a href="https://github.com/lzrdGreen">GitHub</a></p>
    <h3>Dream it. Build it.</h3>
  </footer>


</body>
</html>